# <https://wangdoc.com/bash/variable.html>

## 分类

### 环境变量

`env`命令或`printenv`命令，可以显示所有环境变量。

很多环境变量很少发生变化，而且是只读的，可以视为常量。由于它们的变量名全部都是大写，所以传统上，如果用户要自己定义一个常量，也会使用全部大写的变量名。

注意，Bash 变量名区分大小写，HOME和home是两个不同的变量。

查看单个环境变量的值，可以使用`printenv`命令或`echo`命令。

```
$ printenv PATH
# 或者
$ echo $PATH
```

注意，printenv命令后面的变量名，不用加前缀$。

### 自定义变量

仅在当前 Shell 可用。一旦退出当前 Shell，该变量就不存在了。

`set`命令可以显示所有变量（包括环境变量和自定义变量），以及所有的 Bash 函数。

## 创建变量

变量声明的语法如下。

`variable=value`  
**注意,等号两边不能有空格**

如果变量的值包含空格，则必须将值放在引号中。

`myvar="hello world"`

Bash 没有数据类型的概念，所有的变量值都是字符串。

下面是一些自定义变量的例子。

- a=z                     # 变量 a 赋值为字符串 z
- b="a string"            # 变量值包含空格，就必须放在引号里面
- c="a string and $b"     # 变量值可以引用其他变量的值
- d="\t\ta string\n"      # 变量值可以使用转义字符
- e=$(ls -l foo.txt)      # 变量值可以是命令的执行结果
- f=$((5 * 7))            # 变量值可以是数学运算的结果

如果同一行定义多个变量，必须使用分号（;）分隔。
`$ a=1;b=2`

## 读取变量

读取变量的时候，直接在变量名前加上`$`就可以了。

```
$ foo=bar
$ echo $foo
bar
```

每当 Shell 看到以`$`开头的单词时，就会尝试读取这个变量名对应的值。

如果变量不存在，Bash 不会报错，而会输出空字符。

由于`$`在 Bash 中有特殊含义，把它当作美元符号使用时，一定要非常小心，

```
$ echo I have $100.5 money
I have 00.5 money
```

`$1`被解释为变量,且该变量为空

所以 `\$` 或使用 单引号

读取变量的时候，变量名也可以使用花括号{}包围，比如`$a`也可以写成`${a}`

## 删除变量

`unset`命令用来删除一个变量。

`$ unset a`

这个命令不是很有用。因为不存在的 Bash 变量一律等于空字符串，所以即使unset命令删除了变量，还是可以读取这个变量，值为空字符串。

所以,这与将变量值设为空字符串等价

```
$ foo=''
$ foo=
```

上面两种写法，都是删除了变量foo。由于不存在的值默认为空字符串，所以后一种写法可以在等号右边不写任何值。

## 输出变量

用户创建的变量仅可用于当前 Shell，子 Shell 默认读取不到父 Shell 定义的变量。为了把变量传递给子 Shell，需要使用export命令。这样输出的变量，对于子 Shell 来说就是环境变量。

`export`命令用来向子 Shell 输出变量。

变量的赋值和输出也可以在一个步骤中完成。

上面命令执行后，当前 Shell 及随后新建的子 Shell，都可以读取变量`$NAME`。

子 Shell 如果修改继承的变量，不会影响父 Shell。

## 特殊变量

Bash 提供一些特殊变量。这些变量的值由 Shell 提供，用户不能进行赋值。

## 变量的默认值

Bash 提供四个特殊语法，跟变量的默认值有关，目的是保证变量不为空

- ${varname:-word}  
  else,return 默认值
- ${varname:=word}
  else, var=默认值并return
- ${varname:+word}
  if,return sign;else,返回空
- ${varname:?message}
  else打印错误报告,并中断脚本执行.

## declare命令

declare命令可以声明一些特殊类型的变量，为变量设置一些限制，比如声明只读类型的变量和整数类型的变量。

它的语法形式如下。

`declare OPTION VARIABLE=value`

declare命令的主要参数（OPTION）如下。

- -a：声明数组变量。
- -f：输出所有函数定义。
- -F：输出所有函数名。
- -i：声明整数变量。∴直接数学运算
- -l：声明变量为小写字母。
- -p：查看变量信息。
- -r：声明只读变量。
- -u：声明变量为大写字母。
- -x：该变量输出为环境变量。
  
## randonly命令

`readonly`命令等同于`declare -r`，用来声明只读变量，不能改变变量值，也不能`unset`变量。

## let命令

`let`命令声明变量时，可以直接执行算术表达式。

`let`命令的参数表达式如果包含空格，就需要使用引号。

`let`可以同时对多个变量赋值，赋值表达式之间使用空格分隔。
